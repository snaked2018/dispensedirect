/**
 *  @class
 *  @function AnnouncementBar
 */
if (!customElements.get('announcement-bar')) {
  customElements.define('announcement-bar', class AnnouncementBar extends HTMLElement {
    constructor() {
      super();
    }
    connectedCallback() {
      this.section = this.closest('.announcement-section');

      if (Cookies.get('thb-global-notification') != '1') {
        gsap.to(this, {
          duration: 0.5,
          opacity: '1',
          y: '0%'
        });
        this.close = this.querySelector('.thb-notification-close');

        if (this.close) {
          this.close.addEventListener('click', this.onClick.bind(this));
        }


        window.addEventListener('resize', () => {
          this.setAnnouncementHeight();
        });
        this.setAnnouncementHeight();
        window.dispatchEvent(new Event('resize'));
      }
    }
    onClick() {
      gsap.to(this, {
        y: '-100%',
        padding: 0,
        duration: 0.4,
        onComplete: () => {
          Cookies.set('thb-global-notification', '1', {
            expires: 1
          });
          this.remove();
          this.section.classList.add('announcement-closed');
          this.setAnnouncementHeight();
        }
      });
    }
    setAnnouncementHeight() {
      let h = this.offsetHeight;
      document.documentElement.style.setProperty('--announcement-height', h + 'px');
    }
  });
}